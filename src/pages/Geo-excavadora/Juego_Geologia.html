<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Geo-Excavador: El Desafío Geológico</title>
    <!-- Cargar Tailwind CSS para un estilizado rápido -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      tailwind.config = {
        theme: {
          extend: {
            colors: {
              primary: "#1E6F5C",
              secondary: "#289672",
              accent: "#29BB89",
              light: "#E6DD3B",
              dark: "#1A5653",
            },
          },
        },
      };
    </script>
    <link rel="stylesheet" href="/src/style.css" />
    <style>
      /* Estilo para un tema de excavación */
      body {
        font-family: "Arial", sans-serif;
        background-color: #4a2c1a; /* Marrón oscuro tierra */
        color: #f0e6d2; /* Crema claro */
      }
      /* El lienzo del juego */
      #gameCanvas {
        background-color: #8b4513; /* Marrón silla de montar (tierra base) */
        border: 4px solid #3b200f; /* Borde de madera oscura */
        border-radius: 8px;
        cursor: crosshair; /* Cursor para apuntar */
      }
      /* Estilos para los botones de herramientas */
      .tool-button {
        transition: all 0.2s ease;
        border-width: 4px;
        border-color: #c2b280; /* Arena */
        background-color: #6b4a2d; /* Marrón medio */
        border-radius: 8px;
      }
      .tool-button:hover {
        border-color: #f0e6d2; /* Crema al pasar el ratón */
        transform: scale(1.05);
      }
      /* Estilo para la herramienta seleccionada */
      .tool-button.selected {
        border-color: #ffffff; /* Blanco brillante */
        background-color: #8b6b4a; /* Marrón más claro */
        box-shadow: 0 0 15px rgba(255, 255, 255, 0.5);
      }
      /* Barra de inestabilidad */
      #instability-bar-container {
        background-color: #3b200f; /* Fondo oscuro */
        border-radius: 8px;
        overflow: hidden;
        border: 2px solid #c2b280;
      }
      #instability-bar {
        height: 100%;
        background-color: #28a745; /* Verde (seguro) */
        transition: width 0.3s ease, background-color 0.3s ease;
        /* Efecto de grieta simulado con gradiente */
        background-image: linear-gradient(
          45deg,
          rgba(0, 0, 0, 0.1) 25%,
          transparent 25%,
          transparent 50%,
          rgba(0, 0, 0, 0.1) 50%,
          rgba(0, 0, 0, 0.1) 75%,
          transparent 75%,
          transparent
        );
        background-size: 20px 20px;
      }
      /* Modal para mensajes del juego */
      #game-modal {
        transition: opacity 0.3s ease, transform 0.3s ease;
      }
    </style>
  </head>
  <body class="bg-gray-50 font-sans min-h-screen">
    <div id="header-root"></div>
    <div class="w-full max-w-6xl mx-auto p-4">
      <!-- Título del Juego -->
      <h1
        class="text-4xl font-bold text-center text-yellow-200 mb-4"
        style="text-shadow: 2px 2px 4px #000"
      >
        Geo-Excavador: El Desafío Geológico
      </h1>

      <!-- Contenedor Principal del Juego (Layout inspirado en el mockup) -->
      <div
        class="grid grid-cols-1 md:grid-cols-[1fr_auto_1fr] gap-6 items-start"
      >
        <!-- Panel de Herramientas Izquierdo (Martillos) -->
        <div class="flex md:flex-col gap-4 justify-center">
          <button
            id="tool-hammer"
            class="tool-button p-4 w-20 h-20 flex items-center justify-center selected"
            data-tool="hammer"
          >
            <span class="text-4xl" title="Martillo de Geólogo (Pico)">⛏️</span>
          </button>
          <!-- Espacio para futuros martillos/herramientas pesadas -->
        </div>

        <!-- Área Central del Juego -->
        <div class="flex flex-col items-center">
          <!-- UI Superior (Inestabilidad) -->
          <div class="w-full bg-black/30 p-2 rounded-lg mb-4">
            <div class="flex justify-between items-center mb-1 px-1">
              <span class="text-sm font-bold text-yellow-200"
                >INESTABILIDAD</span
              >
              <span id="instability-text" class="text-sm font-bold text-white"
                >0 / 100</span
              >
            </div>
            <div id="instability-bar-container" class="w-full h-6">
              <div id="instability-bar" style="width: 0%"></div>
            </div>
          </div>

          <!-- Lienzo del Juego -->
          <canvas id="gameCanvas" width="500" height="500"></canvas>
        </div>

        <!-- Panel de Herramientas Derecho (Precisión) -->
        <div class="flex md:flex-col gap-4 justify-center">
          <button
            id="tool-chisel"
            class="tool-button p-4 w-20 h-20 flex items-center justify-center"
            data-tool="chisel"
          >
            <span class="text-4xl" title="Mazo y Cincel">⚒️</span>
          </button>

          <button
            id="tool-grab"
            class="tool-button p-4 w-20 h-20 flex items-center justify-center"
            data-tool="grab"
          >
            <span class="text-4xl" title="Agarrar y mover">✋</span>
          </button>
          <div
            id="bag-drop"
            class="mt-6 w-24 h-24 rounded-lg border-4 border-amber-200 bg-amber-50/40 flex items-center justify-center"
          >
            <img
              src="/img/JuegoGeologia/saco.png"
              alt="Bolsa"
              class="w-16 h-16"
            />
          </div>
          <div
            id="bag-info"
            class="mt-2 w-28 text-xs text-gray-800 bg-amber-50/60 border border-amber-200 rounded p-2"
          >
            <div class="font-semibold">Bolsa</div>
            <div id="bag-stats" class="mt-1"></div>
          </div>
        </div>
      </div>
    </div>
    <div
      id="rules-modal-geologia"
      class="fixed inset-0 bg-black/60 flex items-center justify-center p-4 z-50"
    >
      <div class="bg-white rounded-lg p-6 w-full max-w-md shadow-xl">
        <h3 class="text-xl font-bold mb-4 text-gray-900">Cómo jugar</h3>
        <div class="text-gray-700 space-y-2">
          <p>Selecciona una herramienta y haz clic en la pared.</p>
          <p>La inestabilidad aumenta según la herramienta y la roca.</p>
          <p>Usa la brocha para revelar y el cincel para precisión.</p>
          <p>Extrae los especímenes evitando dañarlos y el derrumbe.</p>
        </div>
        <button
          id="rules-close-geologia"
          class="mt-6 w-full bg-primary hover:bg-dark text-white font-semibold py-2 px-4 rounded-lg"
        >
          Entendido
        </button>
      </div>
    </div>
    <div id="footer-root"></div>

    <!-- Modal del Juego (Para game over, descubrimientos, etc.) -->
    <div
      id="game-modal"
      class="fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center p-4 hidden opacity-0 transform scale-90"
    >
      <div
        class="bg-gray-800 p-6 rounded-lg shadow-2xl border-2 border-yellow-300 max-w-sm w-full text-center"
      >
        <h2
          id="modal-title"
          class="text-2xl font-bold text-yellow-300 mb-4"
        ></h2>
        <p id="modal-message" class="text-white mb-6"></p>
        <button
          id="modal-close-btn"
          class="bg-yellow-500 hover:bg-yellow-400 text-gray-900 font-bold py-2 px-6 rounded-lg"
        >
          Continuar
        </button>
      </div>
    </div>

    <script type="module" src="/src/js/app.js"></script>
    <script type="module" src="./juego_geologia.js"></script>
  </body>
</html>
